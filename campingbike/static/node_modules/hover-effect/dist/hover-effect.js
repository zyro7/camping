var f,l=require("three"),h=(f=require("gsap/TweenMax"))&&"object"==typeof f&&"default"in f?f.default:f;module.exports=function(f){function F(){for(var f=arguments,l=0;l<arguments.length;l++)if(void 0!==f[l])return f[l]}console.log("%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect ","color: #bada55; font-size: 0.8rem");var w=f.parent,L=f.displacementImage,P=f.image1,M=f.image2,U=F(f.intensity1,f.intensity,1),V=F(f.intensity2,f.intensity,1),C=F(f.angle,Math.PI/4),D=F(f.angle1,C),S=F(f.angle2,3*-C),W=F(f.speedIn,f.speed,1.6),_=F(f.speedOut,f.speed,1.2),z=F(f.hover,!0),q=F(f.easing,Expo.easeOut),G=F(f.video,!1);if(w)if(P&&M&&L){var A=new l.Scene,B=new l.OrthographicCamera(w.offsetWidth/-2,w.offsetWidth/2,w.offsetHeight/2,w.offsetHeight/-2,1,1e3);B.position.z=1;var k=new l.WebGLRenderer({antialias:!1,alpha:!0});k.setPixelRatio(window.devicePixelRatio),k.setClearColor(16777215,0),k.setSize(w.offsetWidth,w.offsetHeight),w.appendChild(k.domElement);var J=function(){k.render(A,B)},K=new l.TextureLoader;K.crossOrigin="";var N=K.load(L,J);if(N.wrapS=N.wrapT=l.RepeatWrapping,G){var Q=function(){requestAnimationFrame(Q),k.render(A,B)};Q(),(G=document.createElement("video")).autoplay=!0,G.loop=!0,G.src=P,G.load();var X=document.createElement("video");X.autoplay=!0,X.loop=!0,X.src=M,X.load();var Y=new l.VideoTexture(G),Z=new l.VideoTexture(X);Y.magFilter=Z.magFilter=l.LinearFilter,Y.minFilter=Z.minFilter=l.LinearFilter,X.addEventListener("loadeddata",function(){X.play(),(Z=new l.VideoTexture(X)).magFilter=l.LinearFilter,Z.minFilter=l.LinearFilter,$.uniforms.texture2.value=Z},!1),G.addEventListener("loadeddata",function(){G.play(),(Y=new l.VideoTexture(G)).magFilter=l.LinearFilter,Y.minFilter=l.LinearFilter,$.uniforms.texture1.value=Y},!1)}else Y=K.load(P,J),Z=K.load(M,J),Y.magFilter=Z.magFilter=l.LinearFilter,Y.minFilter=Z.minFilter=l.LinearFilter;var $=new l.ShaderMaterial({uniforms:{intensity1:{type:"f",value:U},intensity2:{type:"f",value:V},dispFactor:{type:"f",value:0},angle1:{type:"f",value:D},angle2:{type:"f",value:S},texture1:{type:"t",value:Y},texture2:{type:"t",value:Z},disp:{type:"t",value:N}},vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\n\nuniform float dispFactor;\nuniform sampler2D disp;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\n\nmat2 getRotM(float angle) {\n  float s = sin(angle);\n  float c = cos(angle);\n  return mat2(c, -s, s, c);\n}\n\nvoid main() {\n  vec4 disp = texture2D(disp, vUv);\n  vec2 dispVec = vec2(disp.r, disp.g);\n  vec2 distortedPosition1 = vUv + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n  vec2 distortedPosition2 = vUv + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n",transparent:!0,opacity:1}),y=new l.PlaneBufferGeometry(w.offsetWidth,w.offsetHeight,1),b=new l.Mesh(y,$);A.add(b),z&&(w.addEventListener("mouseenter",j),w.addEventListener("touchstart",j),w.addEventListener("mouseleave",O),w.addEventListener("touchend",O)),window.addEventListener("resize",function(f){k.setSize(w.offsetWidth,w.offsetHeight)}),this.next=j,this.previous=O}else console.warn("One or more images are missing");else console.warn("Parent missing");function j(){h.to($.uniforms.dispFactor,W,{value:1,ease:q,onUpdate:J,onComplete:J})}function O(){h.to($.uniforms.dispFactor,_,{value:0,ease:q,onUpdate:J,onComplete:J})}};
//# sourceMappingURL=hover-effect.js.map
